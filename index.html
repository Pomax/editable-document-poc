<!DOCTYPE html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <title>test</title>
  <link rel="stylesheet" href="style.css" async />
  <script src="javascript.js" type="module" async></script>
</head>

<body>
  <h1>Creating an editable paragraph</h1>
  <main>
    <div id="cursor"></div>

    <p>
      This is a text, and the idea is that we can put a cursor in here without
      relying on "contenteditable", instead working directly in the paragraph
      itself.
    </p>
  </main>

  <ul>
    <li>clicking places the cursor</li>
    <li>arrow keys move the cursor</li>
    <li>typing (<em>unsurprisingly</em>) inserts text</li>
    <li>backspace removes to the left of the cursor</li>
    <li>delete removes to the right of the cursor</li>
  </ul>

  <h2>How?</h2>

  <p>
    HTML elements contain text nodes, and text nodes can be turned into text
    ranges with metrics that reflect the browser's rendered page. That means we
    can keep track of a "cursor" and visualize that with a little div that's 1px
    wide and a full line high, positioned at "whatever that cursor position's
    corresponding range selection is". Presto. Cursor.
  </p>

  <p>
    Inserting text or breaking up the paragraph then becomes trivial: we just
    update its textContent, and set the cursor position to whatever now makes
    sense.
  </p>

  <p>
    moving the cursor up and down is satisfyingly simple: we simply track the
    cursor's x/y coordinate, and then fake a click for the same x, but a y value
    that has the line height subtracted or added.
  </p>

  <h2>What's left?</h2>

  <p>
    Text selection. Because this is not an OS-level text element, I'm basically
    reimplementing everything from almost-scratch. So for a day one, this'll do
    but it's going to need all the common things like text selection with their
    keyboard or mouse, and really, touch. Because that's a thing, and you should
    support touch events. I currently don't. That's a failing on my part.
  </p>

  <p>
    Anyway, "everything else" aside, the big ones are text selection and making
    the code aware of "other elements" so we can do standard word processor
    things like bold or italics. Making the cursor move across element
    boundaries is pretty important. And spaces. HTML has a fun way to deal with
    white space and it's not the same as what people expect while writing so...
    we'll get there.
  </p>

  <h2>I have ideas</h2>

  <p>
    I expected as much.
    <a href="https://github.com/Pomax/editable-paragraph-element/issues"
      >https://github.com/Pomax/editable-paragraph-element/issues</a
    >
    is there for ideation.
  </p>

  &mdash; <a href="https://mastodon.social/@TheRealPomax">Pomax</a>, 05/25
</body>
